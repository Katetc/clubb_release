<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Linux)">
	<META NAME="AUTHOR" CONTENT="David Schanen">
	<META NAME="CREATED" CONTENT="20060724;11032400">
	<META NAME="CHANGEDBY" CONTENT="David Schanen">
	<META NAME="CHANGED" CONTENT="20070209;17121900">
	<STYLE TYPE="text/css">
	<!--
		@page { size: 8.5in 11in; margin: 1in }
		P { margin-bottom: 0.08in }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<P STYLE="margin-bottom: 0in"><FONT SIZE=6><B>Using the HOC model on
a remote system</B></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal"><FONT SIZE=4><B>Requirements:</B></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal"><BR>
</P>
<OL>
	<LI><P STYLE="margin-bottom: 0in"> <FONT SIZE=4>A Fortran 90/95
	compiler ( </FONT><A HREF="http:/www.g95.org"><FONT SIZE=4>g95</FONT></A><FONT SIZE=4>
	will do fine)</FONT></P>
	<LI><P STYLE="margin-bottom: 0in"> <FONT SIZE=4>A CVS client, or a
	tarball containing the HOC source</FONT></P>
	<LI><P STYLE="margin-bottom: 0in"> <FONT SIZE=4>A working NetCDF
	install with Fortran 90 support enabled</FONT></P>
	<LI><P STYLE="margin-bottom: 0in"><FONT SIZE=4>A POSIX compliant
	shell and make utility to run the scripts.  </FONT><A HREF="http://www.mingw.org/msys.shtml"><FONT SIZE=4>MSYS</FONT></A><FONT SIZE=4>
	or </FONT><A HREF="http://www.gnu.org/software/bash/"><FONT SIZE=4>GNU
	bash</FONT></A><FONT SIZE=4> are usually sufficient.  A Cygwin
	installation works too.</FONT></P>
</OL>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT SIZE=4><B>Getting started:</B></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT SIZE=4>Note:</FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT SIZE=4>I
will assume you're using bash or zsh, and not csh for this document.</FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>export
CVS_RSH=ssh</FONT></FONT></P>
<P STYLE="margin-bottom: 0in"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>You
may wish to add this to your .bashrc;  Note that you may need to
change this back if you wish to use a different CVS repository
elsewhere that does not use ssh.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>We
have 3 basic ways checkout the current branch of HOC:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Basic
source files, no LES data or results:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><FONT FACE="Nimbus Mono L, monospace">cvs
-z 9 -d messner.math.uwm.edu:/cvsroot co hoc_minimal</FONT> </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>LES
data and source files:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>cvs
-z 9 -d messner.math.uwm.edu:/cvsroot co hoc</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Everything:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>cvs
-z 9 -d messner.math.uwm.edu:/cvsroot co hoc_v2.2_tuner</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Note
that '-z' enables compression at level 9, and '-d' defines the cvs
root directory, after which the 'co' command checks out the source.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><B>Changing
the compiler:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Chances
are you do not have the Portland Group Compiler on your remote
system.  Don't sweat it, here's how to change your options:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Edit
config.messner.in to use the location of your g95 installation, or
alternatively, make your own config.whatever.in to point to your
compiler and add it to the beginning of the Makefile. </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>e.g.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>Makefile:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>#include
config.solaris_generic_ss11.in</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>#include
config.osf1_alpha_digital.in</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>#include
config.messner.in</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>include
config.local.in</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>This
is my file, yours will probably need to be different.  The flag for
the processor core in the new 64 bit Pentium 4's is '<FONT FACE="Nimbus Mono L, monospace">-march=nocona</FONT>'.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>config.local.in:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>PREFIX
= ..</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>BINDIR
= $(PREFIX)/bin</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>LIBDIR
= $(PREFIX)/lib</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>FC
= g95 #	G95</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>DEBUG
= -g -C -mieee-fp -ftrace=full #	g95</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>ARCH
= -march=k8 -msse2 -mfpmath=sse # g95, Athlon64</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>NC_LOC
= /usr/local/src/netcdf-3.6.1</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>LDFLAGS
= -L$(LIBDIR) -Wl,-rpath,$(LIBDIR) -lhoc_param -lhoc_bugsrad
-L$(NC_LOC)/lib -lnetcdf</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>FCFLAGS
= $(ARCH) $(DEBUG) -DSTATS -DSCALARS -Dnooverlap -Dradoffline
-I$(NC_LOC)/include</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>AR
= ar</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>ARFLAGS
= cru</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>RANLIB
= ranlib</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><B>Building
the source:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>It's probably
worth noting that on multi processor nodes like Condella and Scott,
you can save yourself a lot of time like so:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>make -j 3</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Where the number
after j is the number of compiler threads.  The general rule of thumb
for threads is the number of processors on the machine plus one,
which may or may not be true for HOC on different compilers and
hosts.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Also you may be
lazy and only want the standalone version:</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>make -j 3
hoc_standalone</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>On
the new dual core machines, this can take only a few seconds.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><B>Checking
in your changes:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Of
course all this would be pointless unless you can do work and check
it back into the repository, right?  If you have added “<FONT FACE="Nimbus Mono L, monospace">export
CVS_RSH=ssh</FONT>” to your .bashrc, you're already half way there.
 All you need to do to check things in is use the cvs commands.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>e.g.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>vi
hoc.F</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><I>(make
changes, test changes)</I></FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>cvs
ci hoc.F</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>(add
comments—note that your EDITOR variable affects which editor pops
up, which you can change in your .bashrc)</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Also
note that you can get the latest version at any time using <FONT FACE="Nimbus Mono L, monospace">cvs
update -d</FONT> from the directory you wish to update.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>e.g.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><BR>
</P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>cd
/home/dschanen/hoc_v2.2_tuner/src</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Mono L, monospace"><FONT SIZE=4>cvs
update -d</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-weight: medium"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><I>(enter
messner node password)</I></FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>and your
directory will be updated and patched.  </FONT></FONT>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>Note that if you
did a hoc_minimal checkout and you are at the root level (e.g.
hoc_v2.2_tuner/) you're going to get all the files in the repository,
which you probably don't want.</FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<BR>
</P>
<P STYLE="margin-bottom: 0in; font-style: normal"><FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4><B>Fin:</B></FONT></FONT></P>
<P STYLE="margin-bottom: 0in; font-style: normal; font-weight: medium">
<FONT FACE="Nimbus Roman No9 L, serif"><FONT SIZE=4>I hope this is
more or less as complete as it needs to be, and you are now
experiencing the pure joy that is running HOC on your own machine.</FONT></FONT></P>
</BODY>
</HTML>