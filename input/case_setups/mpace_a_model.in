! Parameter file for MPACE-A case

&model_setting

! Model Settings

runtype = "mpace_a" ! Case name.

! For grid_type = 1 nzmax can be any nunber
nzmax = 200       ! Number of vertical levels.

grid_type = 1     ! Select grid type:
                  ! 1 ==> evenly-spaced grid levels.
                  ! 2 ==> stretched (unevenly-spaced) grid
                  !       entered on thermodynamic grid levels;
                  !       mom. levels halfway between thermo. levels
                  !       (style of SAM stretched grid).
                  ! 3 ==> stretched (unevenly-spaced) grid
                  !       entered on momentum grid levels;
                  !       thermo. levels halfway between mom. levels
                  !       (style of WRF stretched grid).

! Evenly-spaced grid (grid_type = 1).
! Note:  For this option, both zt_grid_fname and zm_grid_fname must be ''.
deltaz  = 50.0    ! Distance between grid levels on evenly-spaced grid.      [m]
zm_init = 0.0 ! Minimum Altitude of lowest momentum level on any grid. [m]
zm_top = 9950.0 ! Maximum Altitude of highest momentum level on any grid. [m]

! Stretched grid on thermodynamic levels (grid_type = 2).
! Path (from ../run_scripts/) and filename of data file that contains
! thermodynamic level altitudes (in meters).
! Note:  For this option, zm_grid_fname must be ''.
zt_grid_fname = ''

! Stretched grid on momentum levels (grid_type = 3).
! Path (from ../run_scripts/) and filename to data file that contains
! momentum level altitudes (in meters).
! Note:  For this option, zt_grid_fname must be ''.
zm_grid_fname = ''

day   = 5     ! Day of model start (1 to 31).
month = 10    ! Month of model start (1 to 12).
year  = 2004  ! Year of model start.

rlat = 70.5    ! Latitude (0 to 90 for north lat.; 0 to -90 for south lat.) [degrees]
rlon = -154.0  ! Longitude (0 to 180 for east long.; 0 to -180 for west long.) [degrees]

sfc_elevation = 0.0     ! Elevation of ground level [meters above mean sea level]

time_initial = 50400.0  ! Model start time [seconds since midnight on start date]
time_final   = 309600.0 ! Model end time [seconds since midnight on start date]
!time_final   = 50460.0  ! Model end time [seconds since midnight on start date]
time_spinup  = 0.0      ! End of spin-up period [seconds since midnight on start date]

dtmain    = 60.0   ! Model timestep [s]
dtclosure = 60.0   ! Closure timestep [s] (must multiply evenly into dtmain).

sfctype = 0      ! Select surface scheme (cases without specified surface fluxes).
                 ! 0 ==> fixed surface sensible and latent heat fluxes,
                 !       as defined by SE and LE, respectively.
                 ! 1 ==> determine surface sensible and latent heat fluxes
                 !       through a bulk formula that uses the given surface
                 !       temperature (T_sfc) and assumes over ocean.

T_sfc = 271.7528   ! Temperature of underlying surface (e.g. SST)           [K]
p_sfc = 1015.e2    ! Pressure at model base              [Pa]
SE = 0.           ! Fixed surface sensible heat flux    [K m/s]
LE = 0.           ! Fixed surface latent heat flux      [(kg/kg) m/s]

fcor = 1.3747e-4  ! Coriolis parameter                  [s^-1]
T0   = 300.       ! Reference temperature (usually 300) [K]

ts_nudge = 3600.  ! Timescale of u/v nudging            [s]

forcings_file_path = '../input/case_setups/mpace_a_forcings/'

l_tke_aniso    = .true.   ! Flag for anisotropic tke.
l_uv_nudge     = .true.   ! Flag for horizontal wind speed nudging.

! Sponge Damping
!
! tau_sponge_damp_min : Minimum damping time-scale ( at the top0 [s]
! tau_sponge_damp_max : Maximum damping time-scale (base of damping layer) [s]
! sponge_damp_depth   : damping depth as a fraction of domain height [-]
!
thlm_sponge_damp_settings%l_sponge_damping = .false.
thlm_sponge_damp_settings%tau_sponge_damp_min = 60. 
thlm_sponge_damp_settings%tau_sponge_damp_max = 1800. 
thlm_sponge_damp_settings%sponge_damp_depth = 0.25

rtm_sponge_damp_settings%l_sponge_damping = .false.
rtm_sponge_damp_settings%tau_sponge_damp_min = 60. 
rtm_sponge_damp_settings%tau_sponge_damp_max = 1800. 
rtm_sponge_damp_settings%sponge_damp_depth = 0.25

uv_sponge_damp_settings%l_sponge_damping = .false.
uv_sponge_damp_settings%tau_sponge_damp_min = 60. 
uv_sponge_damp_settings%tau_sponge_damp_max = 1800. 
uv_sponge_damp_settings%sponge_damp_depth = 0.25

l_restart      = .false.  ! Flag for whether this is a restart run.
! Path (from ../run_scripts/) and filename of GrADS control files
! (without '_zt.ctl' or '_zm.ctl').
restart_path_case  = "restart/mpace_a"
time_restart  = 0.0      ! Time of model restart.
                         ! [seconds since start time listed in GrADS control file]

! Select debug level:
!        0 => Print no debug messages to the screen
!        1 => Print lightweight debug messages, e.g. print statements
!        2 => Print debug messages that require extra testing,
!                e.g. checks for NaNs and spurious negative values.
debug_level   = 2


! Add scalars that are computed using higher-order closure
! 0 to shut off all scalar computations
! > 0 the specifies the number of columns in <runtype>_sclr_sounding.in 
!	that will be read in and tracked
sclr_dim   = 0  ! Total number of scalars

iisclr_rt  = -1  ! Location in the array to place a scalar like total water
iisclr_thl = -2 ! Location in the array to place a scalar like thetal

sclr_tol  = 1.e-2, 1.e-8 ! Tolerances below which we consider scalar to be 0.

! Add scalars that are computed using simple eddy diffusivity
! 0 to shut off all scalar computations
! > 0 the specifies the number of columns in <runtype>_edsclr_sounding.in 
!	that will be read in and tracked
edsclr_dim  = 0

iiedsclr_rt     = -1 ! Location in the edsclrm array to place total water
iiedsclr_thl    = -2 ! Location in the edsclrm array to place a scalar like thetal


/

&microphysics_setting
! The schemes are: "khairoutdinov_kogan", "morrison", "coamps", "simplified_ice", "none"  
micro_scheme = "morrison",
l_graupel = .false.,
l_arctic_nucl = .true. ! Use MPACE observations for ice nucleation.

! Addition for using latin hypercube sampling
! Variances / Corrlations from the RICO case
rrp2_on_rrainm2_cloud = 0.766  
Nrp2_on_Nrm2_cloud    = 0.429  
Ncp2_on_Ncm2_cloud    = 2.2  
corr_rrNr_LL_cloud    = 0.786
corr_rtrr_NL_cloud    = 0.268
corr_rtNr_NL_cloud    = 0.295
corr_rtNc_NL_cloud    = 0.0 ! Brian
corr_thlrr_NL_cloud   = -0.185
corr_thlNr_NL_cloud   = -0.258
corr_thlNc_NL_cloud   = 0.0 ! Brian
!corr_srr_NL_cloud     = 0.242
!corr_sNr_NL_cloud     = 0.285
!corr_sNc_NL_cloud     = 0.09 ! From ISDAC

rrp2_on_rrainm2_below = 1.  ! Reduced by a factor of 10
Nrp2_on_Nrm2_below    = 1.  ! Reduced
Ncp2_on_Ncm2_below    = 0.
corr_rrNr_LL_below    = 0.886
corr_rtrr_NL_below    = -0.005
corr_rtNr_NL_below    = -0.041
corr_rtNc_NL_below    = 0.0
corr_thlrr_NL_below   = -0.241
corr_thlNr_NL_below   = -0.217
corr_thlNc_NL_below   = 0.0
!corr_srr_NL_below     = 0.056
!corr_sNr_NL_below     = 0.015
!corr_sNc_NL_below     = 0.09 ! From ISDAC

C_evap = 0.5
r_0 = 100.0e-6
Ncm_initial = 70. ! #/cm3 

LH_microphys_type = "disabled",
l_lh_vert_overlap = .true.,
l_lh_cloud_weighted_sampling = .true.,
LH_microphys_calls = 4,
LH_sequence_length = 1,
l_fix_s_t_correlations = .true.,

aer_rm1 = 0.052   ! two aerosol mode defaults from MPACE (from Hugh)
aer_sig1 = 2.04
aer_n1 = 72.2
aer_rm2 = 1.3
aer_sig2 = 2.5
aer_n2 = 1.8

/

&radiation_setting
! The schemes are: "bugsrad", simplified", "simplified_bomex", or "none"
rad_scheme = "simplified",
F0 = 100.0,   ! Coefficient for cloud top heating (see Stevens) [W/m^2] 
F1 = 20.0,    ! Coefficient for cloud base heating (see Stevens)[W/m^2] 
kappa = 119., ! A constant (Duynkerke eqn. 5)                   [m^2/kg]
eff_drop_radius = 1.0e-5, ! Effective droplet radius		[m]
alvdr = 0.1,   ! Visible direct surface albedo        		[-]
gc    = 0.86,  ! Asymmetry parameter, "g" in Duynkerke          [-]
omega = 0.9965,! Single-scattering albedo                       [-] 
Fs_values = 1212.75,
l_sw_radiation = .true.,

! Flag indicating if U.S. Std Atmosphere should 
! be used to extend the grid in radiation.
! If false, sounding data will be used.
l_use_default_std_atmosphere = .true. 

/

&stats_setting

! Statistics Settings

l_stats       = .true.     ! Flag for statistical output.
fname_prefix = "mpace_a"   ! Prefix of output filename.
stats_tsamp  = 60.         ! Frequency of statistical sampling [s]
                           ! For most complete sampling, let 
                           ! stats_tsamp = dtmain
                           ! (stats_tsamp must multiply evenly into stats_tout)
stats_tout   = 600.        ! Frequency of statistical output.  [s]
stats_fmt    = "grads"     ! Type of statistical output file ("grads" or "netcdf").
/

